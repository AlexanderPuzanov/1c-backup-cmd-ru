Инструкция по использованию
скрипта для командной строки
MS Windows для для резервного
копирования баз программы
1C Бухгалтерия 7.7 (файловая версия).


  Скрипт предназначен 
для автоматического запуска по времени
с помощью «Планировщика заданий» на сервере.

 
  Скрипт расчитан на одно создание архива в сутки.
При повторном запуске новый архив не создается.


Все версии скрипта выполняют задачи:

  Создание архивной копии указанного
в настройках скрипта каталога с помощью
программы «WinRar»
( http://www.rarlab.com/download.htm ).
Должна быть установлен по стандартному
пути установки. Версия программы (64/32)
значения не имеет (автоопределение).

  Шифрование архива.
(пароль настраивается в скрипте).

  Авто ограничение количества архивов
(настраивается в скрипте).

  Ведение логов архивирования.
С ограничением длинны логов.
(настраивается в скрипте).


  Отличие версий скрипта
	
  backup.cmd
  Архивирование производится
в каталог в котором находится скрипт.

  backup-to-cloud.cmd
  Архивирование производится в каталог 
для синхронизации с облачным диском 
(рекомендуется использовать «Яндекс Диск»
https://disk.yandex.ru/download/YandexDiskSetup.exe )
каталог в котором находится скрипт
используется для создания служебных файлов.

  backup-to-cloud-email.cmd
  Тоже, что в предыдущем плюс:
Ежемесячно на указанный email высылается
копия файла логов. При ошибках архивирования
высылается email с уведомлением.
  Для отправки email требуется
консольная программа mailsend
( https://github.com/muquit/mailsend/tree/master/bins ).
Рекомендуется использовать версию 1.17b14.
Программа не требует установки.
Внимание! Скрипт предназначен для отправки email
через SMTP сервер Яндекса.


  Установочные файлы необходимых программ
можно найти по указанным ссылкам или
здесь https://github.com/AlexanderPuzanov/1c-backup-cmd-ru/tree/master/vendor


  Скрипты с приставкой dev предназначены 
для разработчиков.
Содержат комментарии по коду.
Не заблокирован вывод сообщений
при работе скрипта.


  Настройки скрипта.
  Устанавливаем значения переменных:
set Переменная=Значения
  Значения переменных указаны в комментариях 
в коде скрипта. 

  Во всех версиях скрипта.
  
rem Тестовый режим.
::  Предназначен для проверки настроек.
::  При ошибках консоль не закрывается,
::  отправляется письмо с вложенным логом
::  на email.
::  1 - включен, 0 - выключен.
set Test_Mode=0
  
rem "Путь к каталогу с базами 1С Бухгалтерия".
set "Source=D:\1C\Base"

rem За сколько дней хранить архивы.
set Number_Archives=30

rem Пароль для архивов.
set Password=123

rem Максимальное количество строк в файле логов.
set Number_Strings_Log=90


  Дополнительно в backup-to-cloud.cmd

rem Путь к каталогу синхронизации с облаком.
set "Backup=E:\YandexDisk\backup-1C"


  Дополнительно в backup-to-cloud-email-dev.cmd

rem Путь к программе mailsend.exe
set "Email_Sender_Program=D:\mailsend\mailsend1.17b14.exe"

rem Данные отправителя.
::  С этой почты будут отправляться
::  уведомления о ошибках.

rem Email отправителя.
::  Email – @yandex.ru
set Email_Sender=backup@yandex.ru

rem Пароль.
set Email_Password=My_Password

rem Данные получателя.
::  На эту почту будут отправляться
::  уведомления о ошибках.
set Email_To=sysadmin@yandex.ru